# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi

alias cnode="srun --partition=debug --nodes=1 --ntasks-per-node=1 --gres=gpu:1 --cpus-per-task=8 --nodelist=babel-0-31 --mem=128G --time=10:00:00 --pty bash"
alias node="srun --partition=debug --nodes=1 --ntasks-per-node=1 --gres=gpu:1 --cpus-per-task=8 --mem=128G --time=10:00:00 --pty bash"
alias cluster_all="$DOTFILES_PYTHON_BIN/python /home/aswerdlo/dotfiles/scripts/matrix/gpu.py --verbose; $DOTFILES/scripts/matrix/lib/whoson -g; $DOTFILES/scripts/matrix/lib/gpu-usage-by-node -p;"
alias mine='squeue --format='\''%.18i %.9P %.50j %.9T %.10M %.15b %.6D %R'\'' --me |  awk '\''NR<2{print $0;next}{print $0| "sort -k3,2"}'\'' | GREP_COLOR='\''01;36'\'' egrep --color=always '\''.*RUNNING.*|$'\'' | GREP_COLOR='\''01;30'\'' egrep -i --color=always '\''.*PENDING.*|$'\'''
alias job_info="sacct --user=$USER --format=JobID,JobName,Partition,Account,AllocCPUS,State,NodeList"
alias codin="conda activate /home/ayushj2/miniconda3/envs/odin"
# User specific environment
if ! [[ "$PATH" =~ "$HOME/.local/bin:$HOME/bin:" ]]
then
    PATH="$HOME/.local/bin:$HOME/bin:$PATH"
fi
export PATH

# Uncomment the following line if you don't like systemctl's auto-paging feature:
# export SYSTEMD_PAGER=

# User specific aliases and functions
if [ -d ~/.bashrc.d ]; then
	for rc in ~/.bashrc.d/*; do
		if [ -f "$rc" ]; then
			. "$rc"
		fi
	done
fi

unset rc
# >>> conda initialize >>>
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$('/home/yjangir/miniconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__conda_setup"
else
    if [ -f "/home/yjangir/miniconda3/etc/profile.d/conda.sh" ]; then
        . "/home/yjangir/miniconda3/etc/profile.d/conda.sh"
    else
        export PATH="/home/yjangir/miniconda3/bin:$PATH"
    fi
fi
unset __conda_setup
# <<< conda initialize <<<
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/nvidia
export APPTAINER_TMPDIR=/scratch
export PATH=~/miniconda3/bin:$PATH

# The next line updates PATH for the Google Cloud SDK.
if [ -f '/home/yjangir/SimplerEnv/google-cloud-sdk/path.bash.inc' ]; then . '/home/yjangir/SimplerEnv/google-cloud-sdk/path.bash.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/home/yjangir/SimplerEnv/google-cloud-sdk/completion.bash.inc' ]; then . '/home/yjangir/SimplerEnv/google-cloud-sdk/completion.bash.inc'; fi
. "$HOME/.cargo/env"

# >>> mamba initialize >>>
# !! Contents within this block are managed by 'micromamba shell init' !!
export MAMBA_EXE='/home/yjangir/bin/micromamba';
export MAMBA_ROOT_PREFIX='/data/user_data/yjangir/yidi/micromamba';
__mamba_setup="$("$MAMBA_EXE" shell hook --shell bash --root-prefix "$MAMBA_ROOT_PREFIX" 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__mamba_setup"
else
    alias micromamba="$MAMBA_EXE"  # Fallback on help from micromamba activate
fi
unset __mamba_setup
qcheck() {
    local path="${1:-.}"   # default to current dir if no arg given
    if [ ! -d "$path" ]; then
        echo "âŒ Path not found: $path"
        return 1
    fi

    echo "ðŸ“¦ Total size of $path:"
    du -sh "$path" 2>/dev/null

    echo ""
    echo "ðŸ“‚ Top folders in $path:"
    du -h --max-depth=1 "$path" 2>/dev/null | sort -h | tail -n 10

    echo ""
    echo "ðŸ’¾ Filesystem usage for $path:"
    df -h "$path" | awk 'NR==1 || NR==2 {print $1, $2, $3, $4, $5}'
}


export HF_HOME=/scratch/yjangir/hf_cache
export HUGGINGFACE_HUB_CACHE=/scratch/yjangir/hf_cache
export TRANSFORMERS_CACHE=/scratch/yjangir/hf_cache
export TORCH_HOME=/scratch/yjangir/torch_cache
export XDG_CACHE_HOME=/scratch/yjangir/conda_cache
export PIP_CACHE_DIR=/scratch/yjangir/conda_cache/pip
export TMPDIR=/scratch/yjangir/tmp

# <<< mamba initialize <<<


# HuggingFace and PyTorch cache directories (added for model weights)
export HF_HOME="/scratch/yjangir/hf_cache"
export HUGGINGFACE_HUB_CACHE="/scratch/yjangir/hf_cache"
export TRANSFORMERS_CACHE="/scratch/yjangir/hf_cache"
export TORCH_HOME="/scratch/yjangir/torch_cache"
export SCRATCH="/scratch/yjangir"
